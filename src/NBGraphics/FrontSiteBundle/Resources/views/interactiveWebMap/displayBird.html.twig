{% extends '@NBGraphicsFrontSite/frontBaseElements.html.twig' %}

{% block title %}{{ bird.taxref.nomVern }} - {{ bird.taxref.nomComplet }}{% endblock %}
{% block description %}{{ bird.comment }}{% endblock %}
{% block keywords %}oiseau, {{ bird.taxref.nomVern }}, maturité {{ bird.matureStage }}, plumage {{ bird.plumage }}, {% if bird.nidification > 0 %}nidification{% else %}pas de nidifcation{% endif %}, {{ bird.quantity }}{% endblock %}
{% block robots %}index{% endblock %}

{% block body %}
  
    <div class="container display-bird">

        <header class="display-bird-header">
            <h2>
                Observation sélectionnée :
                <strong>{{ bird.taxref.nomVern }}</strong>.
            </h2>

            <a class="btn btn-primary prev-step" href="{{ path('nb_graphics_front_site_interactivewebmap') }}">
                Revenir à la carte
            </a>
        </header>


        <div class="show-results">
            {% if bird.image %}
                <img
                        class="bird-image"
                        src="{{ asset('/uploads/img/'~ bird.image.url) | imagine_filter('my_thumb') }}"
                        alt="Photographie de {{ bird.taxref.nomVern }}"
                >
            {% else %}
                <img src="{{ asset('images/400px-Image_manquante_2.svg.png')|imagine_filter('my_thumb') }}" alt="Image manquante">
            {% endif %}
            <div id="map"></div>
        </div>

        <hr>


        <div class="table-responsive">
        <table class="table table-hover">
            <caption>Résultat de l'observation n°{{ bird.id }}</caption>
            <thead>
                <tr>
                    <th>Champ</th>
                    <th>Observation de l'utilisateur</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Famille</td>
                    <td>{{ bird.taxref.famille }}</td>
                </tr>
                <tr>
                    <td>Nom vernaculaire</td>
                    <td>{{ bird.taxref.nomVern }}</td>
                </tr>
                <tr>
                    <td>Nom latin</td>
                    <td>{{ bird.taxref.nomValide }}</td>
                </tr>
                <tr>
                    <td>Nombre</td>
                    <td>{{ bird.quantity }}</td>
                </tr>
                <tr>
                    <td>Maturité</td>
                    <td>{{ bird.matureStage }}</td>
                </tr>
                <tr>
                    <td>Plumage</td>
                    <td>{{ bird.plumage }}</td>
                </tr>
                <tr>
                    <td>Nidification</td>
                    <td>
                      {% if bird.nidification %}
                      oui
                      {% else %}
                      non
                      {% endif %}
                    </td>
                </tr>
                <tr>
                    <td>Date</td>
                    <td>{{ bird.dateAt|date('d/m/Y') }}</td>
                </tr>
                <tr>
                    <td>Heure</td>
                    <td>{{ bird.hourAt|date('H:i') }}</td>
                </tr>
                <tr>
                    <td>Remarques</td>
                    <td>{{ bird.comment|nl2br }}</td>
                </tr>
            </tbody>
        </table>
        </div>


    </div> <!-- End: display-bird Container -->

{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>
        // Initialize The Google Map Element
        var initMap = function() {
            var myLatLng = {
                lat: {{ bird.latitude }},
                lng: {{ bird.longitude }}
            };
            // Create a map object and specify the DOM element for display.
            var map = new google.maps.Map(document.getElementById('map'), {
                center: myLatLng,
                scrollwheel: false,
                zoom: 8,
                {% if is_granted('ROLE_ADMIN') %}
                maxZoom: 18,
                {% else %}
                maxZoom: 10
                {% endif %}
            });
            // Create the marker
            var marker = new google.maps.Marker({
                position: {
                    lat: {{ bird.latitude }},
                    lng: {{ bird.longitude }}
                },
                map: map,
                title: "Lieu de l'observation"
            });
        };
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCv4cK5Ln6Z5EEtoY2gT4zf-J6rVgmnqtw&callback=initMap" async defer></script>
{% endblock %}